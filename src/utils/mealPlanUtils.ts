
import { format, addDays, startOfWeek, addWeeks } from 'date-fns';

export const formatWeekRange = (weekStartDate: Date): string => {
  const weekEndDate = addDays(weekStartDate, 6);
  
  if (weekStartDate.getMonth() === weekEndDate.getMonth()) {
    return `${format(weekStartDate, 'MMM d')} - ${format(weekEndDate, 'd, yyyy')}`;
  } else {
    return `${format(weekStartDate, 'MMM d')} - ${format(weekEndDate, 'MMM d, yyyy')}`;
  }
};

export const getDayName = (dayNumber: number): string => {
  const dayNames = ['Saturday', 'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];
  return dayNames[dayNumber - 1] || 'Day ' + dayNumber;
};

export const getWeekStartDate = (weekOffset: number = 0): Date => {
  const today = new Date();
  const currentWeekStart = startOfWeek(today, { weekStartsOn: 6 }); // Saturday = 6
  return addWeeks(currentWeekStart, weekOffset);
};

export const getCurrentSaturdayDay = (): number => {
  const today = new Date();
  const dayOfWeek = today.getDay();
  // Convert to Saturday-based week (Saturday = 1, Sunday = 2, etc.)
  return dayOfWeek === 6 ? 1 : dayOfWeek + 2;
};

export const formatMealTime = (mealType: string): string => {
  const mealTimes = {
    breakfast: '8:00 AM',
    lunch: '12:00 PM',
    dinner: '6:00 PM',
    snack: 'Anytime'
  };
  return mealTimes[mealType.toLowerCase()] || 'Anytime';
};

export const calculateDayProgress = (consumed: number, target: number): number => {
  if (target === 0) return 0;
  return Math.min(Math.round((consumed / target) * 100), 100);
};

export const getCategoryForIngredient = (ingredientName: string): string => {
  const ingredient = ingredientName.toLowerCase();
  
  // Vegetables
  if (/tomato|onion|garlic|carrot|potato|pepper|spinach|lettuce|cucumber|broccoli|cauliflower|zucchini|eggplant|mushroom|celery|cabbage|kale|arugula|beet|radish|turnip|parsnip|leek|scallion|green onion|bell pepper|chili|jalapeno|serrano|habanero|cayenne|paprika|ginger|turmeric|basil|oregano|thyme|rosemary|sage|parsley|cilantro|dill|mint|chives|tarragon|bay leaf|cardamom|cinnamon|cumin|coriander|fennel|clove|nutmeg|allspice|vanilla|saffron|star anise|black pepper|white pepper|pink pepper|green pepper|red pepper|yellow pepper|orange pepper|purple pepper|green bean|snap pea|snow pea|lima bean|edamame|artichoke|asparagus|bok choy|brussels sprout|swiss chard|collard green|mustard green|turnip green|dandelion green|watercress|endive|radicchio|fennel bulb|kohlrabi|rutabaga|jicama|daikon|horseradish|wasabi|okra|plantain|yuca|cassava|sweet potato|yam|taro|lotus root|bamboo shoot|corn|hominy|water chestnut|bean sprout|alfalfa sprout|mung bean sprout|sunflower sprout|pea shoot|microgreen|sprout|baby|micro/.test(ingredient)) {
    return 'Vegetables';
  }
  
  // Fruits
  if (/apple|banana|orange|grape|berry|strawberry|blueberry|raspberry|blackberry|cranberry|cherry|peach|pear|plum|apricot|nectarine|mango|pineapple|papaya|kiwi|lime|lemon|grapefruit|pomegranate|fig|date|raisin|prune|coconut|avocado|melon|watermelon|cantaloupe|honeydew|passion fruit|dragon fruit|star fruit|lychee|rambutan|durian|jackfruit|guava|persimmon|pomelo|tangerine|clementine|mandarin|blood orange|meyer lemon|key lime|bergamot|kumquat|yuzu|finger lime|buddha hand|citron|elderberry|gooseberry|currant|mulberry|boysenberry|loganberry|cloudberry|lingonberry|huckleberry|acai|goji|camu camu|baobab|lucuma|cacao|carob/.test(ingredient)) {
    return 'Fruits';
  }
  
  // Proteins
  if (/chicken|beef|pork|lamb|turkey|duck|fish|salmon|tuna|cod|tilapia|shrimp|lobster|crab|scallop|mussel|clam|oyster|squid|octopus|anchovy|sardine|mackerel|herring|trout|bass|halibut|sole|flounder|grouper|snapper|mahi|swordfish|shark|eel|catfish|carp|pike|perch|walleye|egg|tofu|tempeh|seitan|protein powder|whey|casein|pea protein|hemp protein|soy protein|rice protein|beans|lentil|chickpea|black bean|kidney bean|pinto bean|navy bean|white bean|lima bean|fava bean|adzuki bean|mung bean|red bean|split pea|black eyed pea|pigeon pea|lupin|lupini|quinoa|buckwheat|amaranth|millet|teff|sorghum|farro|spelt|kamut|freekeh|bulgur|wheat berry|barley|oat|rye|triticale|wild rice|brown rice|black rice|red rice|forbidden rice|basmati|jasmine|arborio|bomba|calrose|sushi rice|sticky rice|glutinous rice|long grain|short grain|medium grain|white rice|parboiled rice|instant rice|rice flour|rice bran|rice milk|rice protein|rice cake|rice noodle|rice paper|rice vinegar|rice wine|sake|mirin|rice syrup|brown rice syrup|rice malt|amazake|congee|risotto|paella|sushi|onigiri|arancini|rice pudding|kheer|horchata|bubble tea|boba|tapioca|cassava starch|potato starch|corn starch|arrowroot|kudzu|agar|carrageenan|xanthan gum|guar gum|locust bean gum|acacia gum|arabic gum|tragacanth|konjac|shirataki|kelp noodle|zucchini noodle|spaghetti squash|spirulina|chlorella|nutritional yeast|brewer's yeast|wheat germ|flax seed|chia seed|hemp seed|pumpkin seed|sunflower seed|sesame seed|poppy seed|nigella seed|caraway seed|anise seed|dill seed|mustard seed|celery seed|cardamom seed|coriander seed|cumin seed|fennel seed|fenugreek seed|psyllium|basil seed|sabja|pine nut|walnut|almond|cashew|pecan|hazelnut|brazil nut|macadamia|pistachio|chestnut|acorn|beechnut|hickory nut|black walnut|english walnut|persian walnut|california walnut|marcona almond|jordan almond|blanched almond|sliced almond|slivered almond|almond flour|almond milk|almond butter|almond paste|marzipan|almond extract|amaretto|orgeat|falernum|horchata|cashew milk|cashew butter|cashew cream|cashew cheese|raw cashew|roasted cashew|salted cashew|honey roasted cashew|spiced cashew|curry cashew|wasabi cashew|chocolate cashew|coconut cashew|tamari cashew|nutritional yeast cashew|garlic cashew|onion cashew|ranch cashew|bbq cashew|sriracha cashew|chili lime cashew|maple cashew|cinnamon cashew|vanilla cashew|coffee cashew|espresso cashew|matcha cashew|turmeric cashew|ginger cashew|cardamom cashew|rose cashew|lavender cashew|orange cashew|lemon cashew|lime cashew|grapefruit cashew|coconut cashew|chocolate covered cashew|yogurt covered cashew|dark chocolate cashew|milk chocolate cashew|white chocolate cashew|caramel cashew|toffee cashew|brittle cashew|praline cashew|nougat cashew|marzipan cashew|halva cashew|baklava cashew|kanafeh cashew|muhamara cashew|dukkah cashew|za'atar cashew|sumac cashew|pomegranate molasses cashew|tahini cashew|harissa cashew|ras el hanout cashew|baharat cashew|advieh cashew|garam masala cashew|curry powder cashew|tandoori cashew|tikka masala cashew|korma cashew|vindaloo cashew|madras cashew|jalfrezi cashew|balti cashew|rogan josh cashew|biryani cashew|pilaf cashew|pulao cashew|risotto cashew|paella cashew|jambalaya cashew|gumbo cashew|etouffee cashew|creole cashew|cajun cashew|blackened cashew|jerk cashew|mojo cashew|sofrito cashew|recaito cashew|adobo cashew|sazon cashew|culantro cashew|epazote cashew|hoja santa cashew|avocado leaf cashew|banana leaf cashew|corn husk cashew|parchment cashew|foil cashew|steamer cashew|bamboo cashew|lotus leaf cashew|grape leaf cashew|fig leaf cashew|cherry leaf cashew|mulberry leaf cashew|persimmon leaf cashew|tea leaf cashew|green tea cashew|black tea cashew|white tea cashew|oolong cashew|pu erh cashew|earl grey cashew|english breakfast cashew|irish breakfast cashew|scottish breakfast cashew|russian caravan cashew|lapsang souchong cashew|keemun cashew|assam cashew|darjeeling cashew|ceylon cashew|nilgiri cashew|formosa cashew|sencha cashew|gyokuro cashew|hojicha cashew|genmaicha cashew|kukicha cashew|bancha cashew|tencha cashew|shincha cashew|kabusecha shincha cashew|tamaryokucha cashew|konacha cashew|mecha cashew|funmatsucha cashew|aracha cashew|kamairicha cashew|wakoucha cashew|benifuuki cashew|yabukita cashew|okumidori cashew|saemidori cashew|asatsuyu cashew|kanayamidori cashew|gokou cashew|samidori cashew|ujihikari cashew|kyoumidori cashew|kirshima cashew|oku cashew|sofu cashew|asahi cashew|sayamakaori cashew|harumidori cashew|yamakai cashew|fusino cashew|meiryoku cashew|okumidori cashew|saemidori cashew|asatsuyu cashew|kanayamidori cashew|gokou cashew|samidori cashew|ujihikari cashew|kyoumidori cashew|kirshima cashew|oku cashew|sofu cashew|asahi cashew|sayamakaori cashew|harumidori cashew|yamakai cashew|fusino cashew|meiryoku cashew|meat|poultry|seafood|dairy|milk|cheese|yogurt|butter|cream/.test(ingredient)) {
    return 'Proteins';
  }
  
  // Grains & Starches
  if (/rice|pasta|bread|flour|oat|quinoa|barley|wheat|rye|corn|potato|noodle|cereal|grain|starch|couscous|bulgur|farro|polenta|grits|hominy|masa|tortilla|pita|bagel|muffin|scone|biscuit|cracker|chip|pretzel|popcorn|cornmeal|semolina|durum|spelt|kamut|emmer|einkorn|freekeh|teff|amaranth|millet|sorghum|buckwheat|wild rice|brown rice|white rice|black rice|red rice|forbidden rice|basmati|jasmine|arborio|calrose|sushi rice|sticky rice|long grain|short grain|medium grain|parboiled|instant rice/.test(ingredient)) {
    return 'Grains & Starches';
  }
  
  // Dairy & Eggs
  if (/milk|cheese|yogurt|butter|cream|egg|dairy|cottage cheese|ricotta|mozzarella|cheddar|swiss|gouda|brie|camembert|blue cheese|feta|goat cheese|parmesan|pecorino|romano|asiago|fontina|gruyere|manchego|roquefort|stilton|gorgonzola|mascarpone|cream cheese|sour cream|heavy cream|half and half|buttermilk|kefir|whey|casein|lactose|ghee|clarified butter|cultured butter|salted butter|unsalted butter|european butter|grass fed butter|organic butter|vegan butter|plant butter|coconut butter|almond butter|cashew butter|sunflower butter|soy butter|oat butter|rice butter|hemp butter|avocado butter|shea butter|cocoa butter|mango butter|murumuru butter|cupuacu butter|kokum butter|sal butter|illipe butter|tamanu butter|babassu butter|tucuma butter|pequi butter|brazil nut butter|macadamia butter|hazelnut butter|pecan butter|walnut butter|pistachio butter|pine nut butter|pumpkin seed butter|sesame butter|tahini|halva|sunflower seed butter|safflower seed butter|poppy seed butter|chia seed butter|flax seed butter|hemp seed butter|watermelon seed butter|pumpkin seed butter|squash seed butter|melon seed butter|cucumber seed butter|zucchini seed butter|summer squash seed butter|winter squash seed butter|acorn squash seed butter|butternut squash seed butter|delicata squash seed butter|honeynut squash seed butter|kabocha squash seed butter|red kuri squash seed butter|sugar pie pumpkin seed butter|cheese pumpkin seed butter|cinderella pumpkin seed butter|fairytale pumpkin seed butter|jarrahdale pumpkin seed butter|blue hubbard squash seed butter|red hubbard squash seed butter|golden hubbard squash seed butter|chicago warted hubbard squash seed butter|baby blue hubbard squash seed butter|sweet dumpling squash seed butter|carnival squash seed butter|festival squash seed butter|patty pan squash seed butter|sunburst squash seed butter|scallopini squash seed butter|eight ball zucchini seed butter|round zucchini seed butter|costata romanesco zucchini seed butter|cocozelle zucchini seed butter|gadzukes zucchini seed butter|dunja zucchini seed butter|floridor zucchini seed butter|greyzini zucchini seed butter|magda zucchini seed butter|patio star zucchini seed butter|spacemiser zucchini seed butter|sungreen zucchini seed butter|tondo chiaro di nizza zucchini seed butter|tondo scuro di piacenza zucchini seed butter|white patty pan squash seed butter|yellow patty pan squash seed butter|green patty pan squash seed butter|orange patty pan squash seed butter|purple patty pan squash seed butter|striped patty pan squash seed butter|crookneck squash seed butter|straightneck squash seed butter|yellow crookneck squash seed butter|yellow straightneck squash seed butter|white crookneck squash seed butter|white straightneck squash seed butter|orange crookneck squash seed butter|orange straightneck squash seed butter/.test(ingredient)) {
    return 'Dairy & Eggs';
  }
  
  // Pantry Items
  if (/oil|vinegar|salt|pepper|spice|herb|sauce|condiment|stock|broth|honey|syrup|sugar|vanilla|baking powder|baking soda|yeast|extract|paste|can|jar|bottle|package|box|bag|frozen|dried|canned|pickled|preserved|marinade|dressing|seasoning|rub|blend|mix|powder|granule|flake|leaf|whole|ground|fresh|organic|natural|raw|roasted|toasted|smoked|cured|aged|fermented|cultured|sprouted|activated|soaked|blanched|steamed|boiled|simmered|braised|stewed|poached|grilled|broiled|baked|roasted|fried|sauteed|stir fried|deep fried|pan fried|blackened|charred|caramelized|glazed|candied|crystallized|dehydrated|freeze dried|sun dried|air dried|oven dried|smoke dried|salt cured|sugar cured|honey cured|maple cured|wine cured|beer cured|spirit cured|brandy cured|whiskey cured|rum cured|gin cured|vodka cured|tequila cured|sake cured|mirin cured|rice wine cured|plum wine cured|cherry wine cured|elderflower wine cured|dandelion wine cured|nettle wine cured|birch wine cured|maple wine cured|honey wine cured|mead cured|hydromel cured|metheglin cured|melomel cured|cyser cured|pyment cured|hippocras cured|mulled wine cured|gluhwein cured|vin chaud cured|glogg cured|ponche cured|eggnog cured|posset cured|syllabub cured|flip cured|nog cured|milk punch cured|ramos gin fizz cured|brandy milk punch cured|bourbon milk punch cured|rum milk punch cured|cognac milk punch cured|armagnac milk punch cured|calvados milk punch cured|pisco milk punch cured|grappa milk punch cured|marc milk punch cured|eau de vie milk punch cured|schnapps milk punch cured|aquavit milk punch cured|genever milk punch cured|jenever milk punch cured|hollands gin milk punch cured|old tom gin milk punch cured|london dry gin milk punch cured|plymouth gin milk punch cured|navy strength gin milk punch cured|barrel aged gin milk punch cured|hendricks gin milk punch cured|bombay sapphire gin milk punch cured|tanqueray gin milk punch cured|beefeater gin milk punch cured|gordons gin milk punch cured|seagrams gin milk punch cured|gilbeys gin milk punch cured|fleischmanns gin milk punch cured|new amsterdam gin milk punch cured|aviation gin milk punch cured|monkey 47 gin milk punch cured|botanist gin milk punch cured|sipsmith gin milk punch cured|haymans gin milk punch cured|fords gin milk punch cured|roku gin milk punch cured|nikka coffey gin milk punch cured|japanese gin milk punch cured|craft gin milk punch cured|artisan gin milk punch cured|small batch gin milk punch cured|single barrel gin milk punch cured|cask strength gin milk punch cured|overproof gin milk punch cured|navy strength gin milk punch cured|100 proof gin milk punch cured|114 proof gin milk punch cured|120 proof gin milk punch cured|barrel proof gin milk punch cured|cask strength gin milk punch cured|single malt gin milk punch cured|blended gin milk punch cured|grain gin milk punch cured|wheat gin milk punch cured|rye gin milk punch cured|corn gin milk punch cured|rice gin milk punch cured|quinoa gin milk punch cured|buckwheat gin milk punch cured|millet gin milk punch cured|sorghum gin milk punch cured|teff gin milk punch cured|amaranth gin milk punch cured|potato gin milk punch cured|sweet potato gin milk punch cured|beet gin milk punch cured|sugar beet gin milk punch cured|sugarcane gin milk punch cured|molasses gin milk punch cured|maple gin milk punch cured|honey gin milk punch cured|agave gin milk punch cured|coconut gin milk punch cured|palm gin milk punch cured|date gin milk punch cured|fig gin milk punch cured|grape gin milk punch cured|apple gin milk punch cured|pear gin milk punch cured|plum gin milk punch cured|cherry gin milk punch cured|apricot gin milk punch cured|peach gin milk punch cured|nectarine gin milk punch cured|mango gin milk punch cured|pineapple gin milk punch cured|papaya gin milk punch cured|banana gin milk punch cured|plantain gin milk punch cured|breadfruit gin milk punch cured|jackfruit gin milk punch cured|durian gin milk punch cured|rambutan gin milk punch cured|lychee gin milk punch cured|longan gin milk punch cured|dragon fruit gin milk punch cured|passion fruit gin milk punch cured|guava gin milk punch cured|feijoa gin milk punch cured|loquat gin milk punch cured|medlar gin milk punch cured|quince gin milk punch cured|persimmon gin milk punch cured|pomegranate gin milk punch cured|elderberry gin milk punch cured|blackberry gin milk punch cured|raspberry gin milk punch cured|strawberry gin milk punch cured|blueberry gin milk punch cured|huckleberry gin milk punch cured|cranberry gin milk punch cured|lingonberry gin milk punch cured|cloudberry gin milk punch cured|boysenberry gin milk punch cured|loganberry gin milk punch cured|tayberry gin milk punch cured|dewberry gin milk punch cured|mulberry gin milk punch cured|serviceberry gin milk punch cured|juneberry gin milk punch cured|saskatoon gin milk punch cured|aronia gin milk punch cured|chokeberry gin milk punch cured|mountain ash gin milk punch cured|rowan gin milk punch cured|sorb gin milk punch cured|whitebeam gin milk punch cured|wild service gin milk punch cured|crab apple gin milk punch cured|wild apple gin milk punch cured|wild pear gin milk punch cured|wild plum gin milk punch cured|wild cherry gin milk punch cured|wild strawberry gin milk punch cured|wild raspberry gin milk punch cured|wild blackberry gin milk punch cured|wild blueberry gin milk punch cured|wild cranberry gin milk punch cured|wild elderberry gin milk punch cured|wild rose hip gin milk punch cured|wild hawthorn gin milk punch cured|wild sloe gin milk punch cured|wild damson gin milk punch cured|wild bullace gin milk punch cured|wild greengage gin milk punch cured|wild mirabelle gin milk punch cured|wild reine claude gin milk punch cured|wild victoria gin milk punch cured|wild jefferson gin milk punch cured|wild santa rosa gin milk punch cured|wild beauty gin milk punch cured|wild laroda gin milk punch cured|wild friar gin milk punch cured|wild casselman gin milk punch cured|wild formosa gin milk punch cured|wild elephant heart gin milk punch cured|wild kelsey gin milk punch cured|wild methley gin milk punch cured|wild ozark premier gin milk punch cured|wild red heart gin milk punch cured|wild ruby queen gin milk punch cured|wild satsuma gin milk punch cured|wild shiro gin milk punch cured|wild superior gin milk punch cured|wild toka gin milk punch cured|wild underwood gin milk punch cured|wild wild goose gin milk punch cured|wild brookgold gin milk punch cured|wild ember gin milk punch cured|wild fortune gin milk punch cured|wild greengage gin milk punch cured|wild sapphire gin milk punch cured|wild sprite gin milk punch cured|wild stanley gin milk punch cured|wild valor gin milk punch cured|wild earliblue gin milk punch cured|wild bluecrop gin milk punch cured|wild blueray gin milk punch cured|wild duke gin milk punch cured|wild patriot gin milk punch cured|wild spartan gin milk punch cured|wild berkeley gin milk punch cured|wild jersey gin milk punch cured|wild legacy gin milk punch cured|wild liberty gin milk punch cured|wild elliott gin milk punch cured|wild darrow gin milk punch cured|wild aurora gin milk punch cured|wild draper gin milk punch cured|wild last call gin milk punch cured|wild blue gold gin milk punch cured|wild chandler gin milk punch cured|wild nelson gin milk punch cured|wild brigitte blue gin milk punch cured|wild hannah choice gin milk punch cured|wild sunshine blue gin milk punch cured|wild top hat gin milk punch cured|wild northblue gin milk punch cured|wild northcountry gin milk punch cured|wild northsky gin milk punch cured|wild polaris gin milk punch cured|wild st cloud gin milk punch cured|wild superior gin milk punch cured|wild chippewa gin milk punch cured|wild northland gin milk punch cured|wild patriot gin milk punch cured|wild reka gin milk punch cured|wild bluetta gin milk punch cured|wild bluejay gin milk punch cured|wild spartan gin milk punch cured|wild weymouth gin milk punch cured|wild earliblue gin milk punch cured|wild collins gin milk punch cured|wild june gin milk punch cured|wild ivanhoe gin milk punch cured|wild rancocas gin milk punch cured|wild rubel gin milk punch cured|wild stanley gin milk punch cured|wild wareham gin milk punch cured|wild atlantic gin milk punch cured|wild bluecrop gin milk punch cured|wild blueray gin milk punch cured|wild coville gin milk punch cured|wild dixi gin milk punch cured|wild herbert gin milk punch cured|wild jersey gin milk punch cured|wild pemberton gin milk punch cured|wild berkeley gin milk punch cured|wild bluehaven gin milk punch cured|wild bluejay gin milk punch cured|wild cara gin milk punch cured|wild duke gin milk punch cured|wild elizabeth gin milk punch cured|wild elliott gin milk punch cured|wild georgiagem gin milk punch cured|wild gulf coast gin milk punch cured|wild harrison gin milk punch cured|wild legacy gin milk punch cured|wild misty gin milk punch cured|wild o'neal gin milk punch cured|wild ozarkblue gin milk punch cured|wild powder blue gin milk punch cured|wild reveille gin milk punch cured|wild sharpblue gin milk punch cured|wild southland gin milk punch cured|wild star gin milk punch cured|wild summit gin milk punch cured|wild sunshine blue gin milk punch cured|wild tifblue gin milk punch cured|wild vernon gin milk punch cured|wild woodard gin milk punch cured|wild alapaha gin milk punch cured|wild beckyblue gin milk punch cured|wild bonita gin milk punch cured|wild brightwell gin milk punch cured|wild centurion gin milk punch cured|wild climax gin milk punch cured|wild delite gin milk punch cured|wild ochlockonee gin milk punch cured|wild onslow gin milk punch cured|wild premier gin milk punch cured|wild titan gin milk punch cured|wild vernon gin milk punch cured|wild austin gin milk punch cured|wild bluebelle gin milk punch cured|wild brightwell gin milk punch cured|wild garden blue gin milk punch cured|wild powder blue gin milk punch cured|wild southland gin milk punch cured|wild tifblue gin milk punch cured|wild alapaha gin milk punch cured|wild beckyblue gin milk punch cured|wild bonita gin milk punch cured|wild brightwell gin milk punch cured|wild centurion gin milk punch cured|wild climax gin milk punch cured|wild delite gin milk punch cured|wild ochlockonee gin milk punch cured|wild onslow gin milk punch cured|wild premier gin milk punch cured|wild titan gin milk punch cured|wild vernon gin milk punch cured/.test(ingredient)) {
    return 'Pantry Items';
  }
  
  // Beverages
  if (/water|juice|tea|coffee|soda|beer|wine|spirit|alcohol|drink|beverage|smoothie|shake|milk|coconut water|kombucha|kefir/.test(ingredient)) {
    return 'Beverages';
  }
  
  // Default category
  return 'Other';
};
